{
    "dataProductDescriptor": "1.0.0",
    "info": {
        "name": "yellowTripsDailyStats",
        "version": "1.0.0",
        "domain": "mobility",
        "displayName": "Yellow Trips Daily Stats",
        "summary": "Expose daily stats about yellow taxi trips in NY",
        "owner": {
            "id": "john.doe@company-xyz.com",
            "name": "John Doe"
        }
    },
    "interfaceComponents": {
        "inputPorts": [
            {
                "name": "tlcTripRecordDataInputPort",
                "version": "1.0.0",
                "dependsOn": "urn:dpds:com.bouplanlabs:dataproducts:tlcTripRecordDP:1:outputports:streamingUpdatesPort",
                "promises": {
                    "updateFrequency": "0 1 * * *"
                },
                "expectations": {
                    "api": {
                        "specification": "datastoreapi",
                        "definition": {
                            "datastoreapi": "1.0.0",
                            "info": {
                                "title": "tlcTripRecordDataAPI",
                                "version": "1.0.0",
                                "datastoreName": "tlcTripIngestionDatastore"
                            },
                            "services": {
                                "production": {
                                    "name:": "datalake",
                                    "serverInfo": {
                                        "connectionProtocols": {
                                            "iceberg": {
                                                "catalog-type": "rest",
                                                "uri": "http://iceberg-rest-server:8181"
                                            }
                                        }
                                    }
                                }
                            },
                            "schema": {
                                "databaseName": "amountStatsTable",
                                "tables": [
                                    {
                                        "tpep_pickup_datetime ": {
                                            "type": "string"
                                        },
                                        "Tip_amount": {
                                            "type": "number"
                                        },
                                        "Tolls_amount": {
                                            "type": "number"
                                        },
                                        "Total_amount": {
                                            "type": "number"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                }
            }
        ],
        "outputPorts": [
            {
                "name": "amountStats",
                "version": "1.0.0",
                "displayName": "Exposes daily stats about the avarage amount per trip",
                "promises": {
                    "api": {
                        "specification": "datastoreapi",
                        "definition": {
                            "datastoreapi": "1.0.0",
                            "info": {
                                "title": "amauntStatsAPI",
                                "version": "1.0.0",
                                "datastoreName": "amountStatsConsumptionDatastore"
                            },
                            "services": {
                                "production": {
                                    "name:": "datalake",
                                    "serverInfo": {
                                        "connectionProtocols": {
                                            "iceberg": {
                                                "catalog-type": "rest",
                                                "uri": "http://iceberg-rest-server:8181"
                                            }
                                        }
                                    }
                                }
                            },
                            "schema": {
                                "databaseName": "amountStatsTable",
                                "tables": [
                                    {
                                        "quality": [
                                             {
                                                "rule": "freshness",
                                                "mustBeLessThen": "1",
                                                "unit": "day"
                                            }],
                                        "properties": {
                                            "tripDate": {
                                                "type": "string",
                                                "quality": [
                                                    {
                                                        "rule": "duplicateCount",
                                                        "mustBeEqualTo": "0",
                                                        "unit": "row"
                                                    },
                                                    {
                                                        "rule": "matchFormat",
                                                        "params": {
                                                            "regex": "^(0[1-9]|[12][0-9]|3[01])/(0[1-9]|1[0-2])/\\d{4}$"
                                                        },
                                                        "mustBeEqualTo": "100",
                                                        "unit": "percet"
                                                    }
                                                ]
                                            },
                                            "avgTotal": {
                                                "type": "number"
                                            },
                                            "avgTolls": {
                                                "type": "number"
                                            },
                                            "avgTip": {
                                                "type": "number"
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    }
                }
            }
        ]
    }
}